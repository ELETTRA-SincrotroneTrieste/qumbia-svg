<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>qumbia-svg: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">qumbia-svg
   &#160;<span id="projectnumber">1.x</span>
   </div>
   <div id="projectbrief">Qt SVG cumbia integration module</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">qumbia-svg Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="qusvg_title"></a>
cumbia Qt Svg integration module</h1>
<p>The qumbia-svg module connects Qt Svg objects to cumbia.</p>
<p>The <a href="https://doc.qt.io/qt-5/qtsvg-module.html">Qt SVG C++ module</a> provides functionality for handling SVG images. The <em>cumbia</em> engines and infrastructures can be used to change any SVG element. An <em>svg</em> node with the <em>item</em> attribute defined and not set to <em>false</em> is rendered in a dedicated <a class="el" href="classQuGraphicsSvgItem.html">QuGraphicsSvgItem</a>, an extension of the Qt <a href="https://doc.qt.io/qt-5/qgraphicssvgitem.html">QGraphicsSvgItem</a>. <a class="el" href="classQuGraphicsSvgItem.html">QuGraphicsSvgItem</a> represents the "*item*" node and its children on a <a href="https://doc.qt.io/qt-5/qgraphicsscene.html">QGraphicsScene</a>. The <a href="https://doc.qt.io/qt-5/qgraphicsscene.html">QGraphicsScene</a> class provides a surface for managing a large number of 2D graphical items.</p>
<h2><a class="anchor" id="load_svg"></a>
Loading documents</h2>
<p>SVG documents are loaded from files or directly from strings by the loadFile and loadSvg functions respectively.</p>
<h2><a class="anchor" id="display_content"></a>
Display content</h2>
<p>Svg content is displayed by <a class="el" href="classQuSvgView.html">QuSvgView</a>, whose constructor takes an instance of QumbiaSvg. <a class="el" href="classQuSvgView.html">QuSvgView</a> is a QGraphicsView that will display one QGraphicsSvgItem for each element in the svg document with the <em>item</em> attribute defined and not set to "false".</p>
<h3><a class="anchor" id="main_classes"></a>
Classes</h3>
<p><a class="el" href="classQuSvg.html">QuSvg</a> (main class), <a class="el" href="classQuDom.html" title="The QuDom class loads and represents the DOM of the svg source.">QuDom</a> (DOM representation), <a class="el" href="classQuDomElement.html">QuDomElement</a> (QDomElement wrapper with improved search and access functionality), <a class="el" href="classQuGraphicsSvgItem.html">QuGraphicsSvgItem</a> (extends QGraphicsSvgItem), <a class="el" href="classQuSvgView.html">QuSvgView</a> (<a href="https://doc.qt.io/qt-5/qgraphicsscene.html">QGraphicsView</a> extension that creates items, manages zoom operations, signals click and context menu events).</p>
<h2><a class="anchor" id="accessing_items"></a>
Accessing items and attributes</h2>
<p>Items, that map the <em>nodes</em> defined in the <em>svg</em> DOM document, can be accessed in a very simple fashion by means of their <em>id</em> within the <em>square brackets</em> operator defined in the <a class="el" href="classQuDom.html" title="The QuDom class loads and represents the DOM of the svg source.">QuDom</a> and <a class="el" href="classQuDomElement.html">QuDomElement</a> classes. Slash ('/') separate <em>ids</em> can be specified to traverse the DOM more efficiently through a hierarchical path.</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> <a class="code" href="classQuDom.html">QuDom</a>* qudom = m_qusvg-&gt;quDom(); <span class="comment">// m_qusvg is a reference to QuSvg</span></div><div class="line"><span class="keyword">const</span> <a class="code" href="classQuDomElement.html">QuDomElement</a> root(*qudom);</div><div class="line">root[<span class="stringliteral">&quot;ellipse/blue_circle&quot;</span>].a(<span class="stringliteral">&quot;style/fill&quot;</span>, <span class="stringliteral">&quot;#ffffff&quot;</span>); <span class="comment">// white</span></div><div class="line">root[<span class="stringliteral">&quot;lil_star&quot;</span>].a(<span class="stringliteral">&quot;style/fill&quot;</span>, <span class="stringliteral">&quot;#ff0000&quot;</span>); <span class="comment">// red</span></div></div><!-- fragment --><div class="image">
<img src="svg_circle_attributes_access.png" alt="svg_circle_attributes_access.png"/>
<div class="caption">
Fig 1. Items after changing style/fill property</div></div>
 <h2><a class="anchor" id="cumbia_connect"></a>
Connect to sources</h2>
<p>Each property of a svg object can be <em>connected</em> to a cumbia <em>source</em>. The connection can be directly defined in the <em>svg</em> file, by introducing a *&lt;read&gt;* element as <em>direct child</em> of the target element. The *&lt;read&gt;* element will contain the following attributes</p><ul>
<li><em>src</em> (compulsory): specifies the name of the source of data</li>
<li><em>attribute</em>: specifies the <em>target attribute</em> in the <em>parent</em> that will be changed upon new data from <em>src</em>.</li>
<li><em>hint</em> suggest <em>cumbia-svg</em> which key to use to fetch the value from the <em>data bundle</em>. In the example below, <em>state_color</em> is used to extract the color that will be used to change the <em>fill</em> property of the <em>style</em> attribute of the parent *&lt;rect&gt;*.</li>
</ul>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">rect elements changing their colors according to a Tango state  </th><th class="markdownTableHeadNone">svg code to declare an item with a reader   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><div class="image">
<img src="svg_demo.gif" alt="svg_demo.gif"/>
</div>
     </td><td class="markdownTableBodyNone"><div class="image">
<img src="svg_read_src.png" alt="svg_read_src.png"/>
</div>
      </td></tr>
</table>
<p><em>attribute</em> can be omitted if it is clear from the context what is the target of the data update <em>in the parent</em>. For example, the parent is a *&lt;text&gt;* node.</p>
<p>In the svg source snippet below</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">source connected to a <em>text</em> node  </th><th class="markdownTableHeadNone">text label   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><div class="image">
<img src="svg_text_read_src.png" alt="svg_text_read_src.png"/>
</div>
     </td><td class="markdownTableBodyNone"><div class="image">
<img src="svg_text.gif" alt="svg_text.gif"/>
</div>
      </td></tr>
</table>
<p>it is easy for <em>cumbia-svg</em> to understand that the value of <em>long_scalar</em> will update the text node child of &lt;svg:text&gt; with id <em>ducktext</em>.</p>
<p>In a similar way, under the *&lt;read&gt;* node, the <em>hint=state_color</em> linked to the <em>style/fill</em> target attribute in Fig. 1 will update the <em>fill color</em> of the parent *&lt;rect&gt;*.</p>
<p>Please see also <a class="el" href="classQuSvgReadLink.html#a5e946c76ed9465d5f948eb91f6373919" title="QuSvgReadLink::isValid returns true if the information stored is enough.">QuSvgReadLink::isValid</a></p>
<h3><a class="anchor" id="src_names"></a>
Source names</h3>
<p>Source names must be conform to the syntax understood by the available engines, e.g. Tango, EPICS, random</p>
<h2><a class="anchor" id="data_update"></a>
Data update</h2>
<p>When possible, the value of the source is directly updated: a number displayed on a text label or the color of a state. In the other cases (an item position change after a change in a value or a circle radius change proportional to another quantity) custom mappings and transformations can be defined.</p>
<h2><a class="anchor" id="target_and_events"></a>
Target names and item events</h2>
<h3><a class="anchor" id="targets"></a>
Targets</h3>
<p>Target names must be conform to the syntax understood by the available engines, e.g. Tango, EPICS, random. Writings without arguments, like those triggered by a <em>push button</em>, can be done through a <em>clickable item</em>. Those involving input values are performed by dedicated dialogs, either executed from a contextual menu or a simple click. Items with a <em>target</em> attribute defined and the <em>clickable</em> attribute set to <em>true</em> will start a write operation after a left button click event. Items with a <em>target</em> attribute defined and <em>without</em> a clickable attribute will make a write operation available through a contextual menu. In the latter case, if an <em>action</em> string attribute is defined, its value will be set as text in the contextual menu action associated. The <em>type</em> attribute defines the type of desired <em>writer</em> used in the pop up dialog. Its value can be one of (case insensitive):</p><ul>
<li>"quapplynumeric"</li>
<li>"qubutton"</li>
<li>"quinputoutput"</li>
<li>"qulineedit"</li>
</ul>
<h3><a class="anchor" id="Item"></a>
events.</h3>
<p>If an item has the <em>clickable</em> attribute set to true, it will be highlighted when mouse enters the item as well as a click operation is performed. <a class="el" href="classQuSvgView.html">QuSvgView</a> itemContextMenuRequest and itemClicked signals are emitted according to the event detected.</p>
<p>The following scenarios are valid:</p><ul>
<li><em>target and clickable defined, type not defined</em>: left button click executes the operation as written in the <em>target</em> attribute value</li>
<li><em>target, clickable and type are defined</em>: left click pops up a dialog with a widget of the desired type.</li>
<li><em>target and type defined, clickable not defined</em>: a context menu provides an action to execute a dialog with the desired widget to execute the target;</li>
<li><em>target defined, clickable and type not defined</em>: a context menu provides an action to execute a dialog with a <em>simple apply button</em> to execute the command as specified in <em>target</em></li>
<li><em>target, clickable and type</em> not defined: itemContextMenuRequest signal only is emitted upon right click</li>
<li><em>clickable defined, target and type not defined</em>, itemClicked is emitted on left button click, itemContextMenuRequest is emitted on right button click. </li>
</ul>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Feb 27 2020 16:10:32 for qumbia-svg by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
